var ka markup n ne ika a m cag ya ca ia sa Da w zg la rf va yag iag sag u eu eu_aux rd premd DY4 PS markup_n rf1 
FE_1 n_1 x_1 k_1 l_1 z_1 rk_1 rz_1 markup_1 ka_1 za_1 la_1 ia_1 sa_1 phik_1 phiz_1 phiprik_1 phipriz_1 lambdak_1 lambdaz_1 ne_1 V_1 D_1 Da_1 va_1 rd_1 premd_1 pa_1 p_1 
FE_2 n_2 x_2 k_2 l_2 z_2 rk_2 rz_2 markup_2 ka_2 za_2 la_2 ia_2 sa_2 phik_2 phiz_2 phiprik_2 phipriz_2 lambdak_2 lambdaz_2 ne_2 V_2 D_2 Da_2 va_2 rd_2 premd_2 pa_2 p_2 
;

varexo eps eist_i eist_s ;

parameters beta psi gamma theta nu1 nu2 alpha rho eta deltak deltaz sigma_ist_i sigma_ist_s 
zetak zetaz deltan alpha1k alpha2k alpha1z alpha2z kappa sigma Chi0 chi VCONST Lline Zgbar Yabar
 
kappa_1 astar_1 Nbar_1 NEbar_1 PHI_1 kappa_2 astar_2 Nbar_2 NEbar_2 PHI_2 ; 

beta = 0.991449334942;
psi = 1.750000000000;
gamma = 10.000000000000;
theta = 22.000000000000;
nu1 = 1.150000000000;
nu2 = 5.868126833096;
alpha = 0.330000000000;
rho = 0.987258544901;
eta = 0.100000000000;
deltak = 0.020000000000;
deltaz = 0.037500000000;
zetak = 0.530746344262;
zetaz = 0.921985249207;
deltan = 0.020000000000;
Zbar = 0.201953311323;
Zbar = 0.506071399033;
alpha1k = 0.001629388467;
alpha2k = 0.070612990433;
alpha1z = 0.039339634066;
alpha2z = 0.649049101463;
kappa = 1.226118924081;
kappa = 1.226118924081;
Lline = 1.000000000000;
sigma = 0.015937803735;
sigma_ist_i = 0.037000283633;
sigma_ist_s = -0.000053580186;
kappa_1 = 1.226118924081;
astar_1 = -0.005144023010;
Nbar_1 = 5.434835847969;
NEbar_1 = 0.110915017305;
PHI_1 = 0.000563440543;
kappa_2 = 1.226118924081;
astar_2 = -0.005144023010;
Nbar_2 = 1.783181001199;
NEbar_2 = 0.036391449004;
PHI_2 = 0.034203315258;
Yabar = 1.073671853916;
Zgbar = 1.013135403903;
Chi0 = 0.654209186360;
chi = 3.000000000000;
VCONST = 369.684794616230;

model;
exp(u) = ( exp((1-1/psi)*ca)/(1-1/psi) + Chi0 * (Lline-exp(la))^(1-chi)/(1-chi) + beta*exp(eu) );
exp(eu) = VCONST * Zgbar^(1-1/psi) * exp((1/(1-theta))*eu_aux) ;
exp(eu_aux) = ( exp((1-1/psi)*zg+u(1)) / (VCONST * Zgbar^(1-1/psi)) )^(1-theta);
exp(m) = beta*(exp(u-eu(-1)))^(- theta)*exp( - 1/psi*cag - theta*( (1-1/psi)*zg(-1) ));
ika = ia-ka(-1);
exp(w) = (Chi0*(Lline-exp(la))^(-chi)) / exp(-1/psi*ca)  ;
exp(-rf) = exp(m(1));
exp(-rf1) = exp(m(1)+m(2)+m(3)+m(4));
exp(markup) = (1-alpha)*exp(ya-w-la);
1  = (0 + 1/2*exp((1-nu1)*pa_1)  +  1/2*exp((1-nu1)*pa_2)  + 0)^(1/(1-nu1)) ;
1  = 0 + 1/2*exp(za_1)  +  1/2*exp(za_2)  + 0 ;
exp(la)  = 0 + 1/2*exp(la_1)  +  1/2*exp(la_2)  + 0 ;
exp(ia)  = 0 + 1/2*exp(ia_1)  +  1/2*exp(ia_2)  + 0 ;
exp(sa)  = 0 + 1/2*exp(sa_1)  +  1/2*exp(sa_2)  + 0 ;
exp(ca)  = exp(ya) - exp(ia) - exp(sa) - 1/2*exp(ne_1)*FE_1  - 1/2*PHI_1*exp(ka_1(-1)) -  1/2*exp(ne_2)*FE_2  - 1/2*PHI_2*exp(ka_2(-1)) - 0 ;
exp(ka)  = 0 + 1/2*exp(ka_1)  +  1/2*exp(ka_2)  + 0 ;
Da  = 0 + 1/2*(Da_1)  +  1/2*(Da_2)  + 0 ;
exp(n)  = 0 + 1/2*exp(n_1)  +  1/2*exp(n_2)  + 0 ;
exp(markup_n) = ( -nu2*exp(n(-1)) + (nu2-nu1) ) / ( -(nu2-1)*exp(n(-1)) + (nu2-nu1) ) ;
exp(ne)  = 0 + 1/2*exp(ne_1)  +  1/2*exp(ne_2)  + 0 ;
exp(va) = Da + exp(m(1) + va(1) + zg);
exp(rd) = exp(va+zg(-1))/(exp(va(-1)) - Da(-1));
DY4 = ( Da + Da(-1)/exp(zg(-1)) + Da(-2)/exp(zg(-1)+zg(-2)) + Da(-3)/exp(zg(-1)+zg(-2)+zg(-3)) ) / exp(va);
premd = (rd - rf(-1))*(1+2/3);
PS = (Da)/exp(ya);
cag = ca - ca(-1) + zg(-1);
yag = ya - ya(-1) + zg(-1);
sag = sa - sa(-1) + zg(-1);
iag = ia - ia(-1) + zg(-1);
a = rho*a(-1) + sigma*eps;
FE_1 = kappa_1;
exp(x_1) = exp(ya-nu1*pa_1-nu2*(p_1-pa_1));
exp(pa_1) = exp( 1/(1-nu2)*n_1(-1) + p_1 );
exp(ka_1) = exp(n_1 + k_1);
exp(za_1) = exp(n_1 + z_1);
exp(x_1) = exp( alpha*k_1(-1) + (1-alpha)*(astar_1+a+l_1+eta*z_1(-1)) );
exp(rk_1) = exp(-markup_1)*        alpha*exp(p_1+x_1-k_1(-1));
exp(rz_1) = exp(-markup_1)*eta*(1-alpha)*exp(p_1+x_1-z_1(-1));
exp(w)  = exp(-markup_1)*(1-alpha)      *exp(p_1+x_1-l_1);
exp(markup_1) = ( -nu2*exp(n_1(-1)) + (nu2-nu1) ) / ( -(nu2-1)*exp(n_1(-1)) + (nu2-nu1) ) ;
exp(l_1) = exp(la_1)/exp(n_1(-1));
exp(phik_1-sigma_ist_i*eist_i) = (alpha1k/(1-(1/zetak)))*exp( (1-(1/zetak))*(ia_1-ka_1(-1)) ) + alpha2k;
exp(phiprik_1-sigma_ist_i*eist_i) = alpha1k*exp( (-1/zetak)*(ia_1-ka_1(-1)) );
exp(lambdak_1) = exp(-phiprik_1);
exp(lambdak_1) = exp(m(1))*( exp(rk_1(1)) + exp(lambdak_1(1))*(1-deltak-exp(phiprik_1(1)+ia_1(1)-ka_1)+exp(phik_1(1))) );
exp(ka_1+zg) = (1-deltak)*exp(ka_1(-1)) + exp(phik_1+ka_1(-1));
exp(phiz_1-sigma_ist_s*eist_s) = (alpha1z/(1-(1/zetaz)))*exp( (1-(1/zetaz))*(sa_1-za_1(-1)) ) + alpha2z;
exp(phipriz_1-sigma_ist_s*eist_s) = alpha1z*exp( (-1/zetaz)*(sa_1-za_1(-1)) );
exp(lambdaz_1) = exp(-phipriz_1);
exp(lambdaz_1) = exp(m(1))*( exp(rz_1(1)) + exp(lambdaz_1(1))*(1-deltaz-exp(phipriz_1(1)+sa_1(1)-za_1)+exp(phiz_1(1))) );
exp(za_1+zg) = (1-deltaz)*exp(za_1(-1)) + exp(phiz_1+za_1(-1));
exp(n_1) = (1-deltan)*(exp(n_1(-1)) + exp(ne_1));
(1-deltan)*exp(m(1)+zg)*V_1(1) = FE_1; 
D_1 = exp(p_1+x_1) - exp(w+l_1) - exp(rk_1+k_1(-1)) - exp(rz_1+z_1(-1)) - PHI_1*exp(k_1(-1));
V_1 = D_1 + (1-deltan)*exp(m(1)+zg)*V_1(1);
Da_1 = exp(n_1(-1))*D_1 - exp(ne_1)*FE_1 + exp(rk_1+ka_1(-1)) + exp(rz_1+za_1(-1)) - exp(ia_1) - exp(sa_1);
exp(va_1) = Da_1 + exp(m(1) + va_1(1) + zg);
exp(rd_1) = exp(va_1+zg(-1))/(exp(va_1(-1)) - Da_1(-1));
premd_1 = (rd_1 - rf(-1))*(1+2/3);
FE_2 = kappa_2;
exp(x_2) = exp(ya-nu1*pa_2-nu2*(p_2-pa_2));
exp(pa_2) = exp( 1/(1-nu2)*n_2(-1) + p_2 );
exp(ka_2) = exp(n_2 + k_2);
exp(za_2) = exp(n_2 + z_2);
exp(x_2) = exp( alpha*k_2(-1) + (1-alpha)*(astar_2+a+l_2+eta*z_2(-1)) );
exp(rk_2) = exp(-markup_2)*        alpha*exp(p_2+x_2-k_2(-1));
exp(rz_2) = exp(-markup_2)*eta*(1-alpha)*exp(p_2+x_2-z_2(-1));
exp(w)  = exp(-markup_2)*(1-alpha)      *exp(p_2+x_2-l_2);
exp(markup_2) = ( -nu2*exp(n_2(-1)) + (nu2-nu1) ) / ( -(nu2-1)*exp(n_2(-1)) + (nu2-nu1) ) ;
exp(l_2) = exp(la_2)/exp(n_2(-1));
exp(phik_2-sigma_ist_i*eist_i) = (alpha1k/(1-(1/zetak)))*exp( (1-(1/zetak))*(ia_2-ka_2(-1)) ) + alpha2k;
exp(phiprik_2-sigma_ist_i*eist_i) = alpha1k*exp( (-1/zetak)*(ia_2-ka_2(-1)) );
exp(lambdak_2) = exp(-phiprik_2);
exp(lambdak_2) = exp(m(1))*( exp(rk_2(1)) + exp(lambdak_2(1))*(1-deltak-exp(phiprik_2(1)+ia_2(1)-ka_2)+exp(phik_2(1))) );
exp(ka_2+zg) = (1-deltak)*exp(ka_2(-1)) + exp(phik_2+ka_2(-1));
exp(phiz_2-sigma_ist_s*eist_s) = (alpha1z/(1-(1/zetaz)))*exp( (1-(1/zetaz))*(sa_2-za_2(-1)) ) + alpha2z;
exp(phipriz_2-sigma_ist_s*eist_s) = alpha1z*exp( (-1/zetaz)*(sa_2-za_2(-1)) );
exp(lambdaz_2) = exp(-phipriz_2);
exp(lambdaz_2) = exp(m(1))*( exp(rz_2(1)) + exp(lambdaz_2(1))*(1-deltaz-exp(phipriz_2(1)+sa_2(1)-za_2)+exp(phiz_2(1))) );
exp(za_2+zg) = (1-deltaz)*exp(za_2(-1)) + exp(phiz_2+za_2(-1));
exp(n_2) = (1-deltan)*(exp(n_2(-1)) + exp(ne_2));
(1-deltan)*exp(m(1)+zg)*V_2(1) = FE_2; 
D_2 = exp(p_2+x_2) - exp(w+l_2) - exp(rk_2+k_2(-1)) - exp(rz_2+z_2(-1)) - PHI_2*exp(k_2(-1));
V_2 = D_2 + (1-deltan)*exp(m(1)+zg)*V_2(1);
Da_2 = exp(n_2(-1))*D_2 - exp(ne_2)*FE_2 + exp(rk_2+ka_2(-1)) + exp(rz_2+za_2(-1)) - exp(ia_2) - exp(sa_2);
exp(va_2) = Da_2 + exp(m(1) + va_2(1) + zg);
exp(rd_2) = exp(va_2+zg(-1))/(exp(va_2(-1)) - Da_2(-1));
premd_2 = (rd_2 - rf(-1))*(1+2/3);
end;

initval;
u = 5.912650736117;
eu = 5.918243542935;
eu_aux = 0.000000000000;
m = -0.016044507489;
cag = 0.013049882576;
ya = 0.071084413010;
ca = -0.552471554362;
ia = -1.418164049190;
sa = -2.983104265472;
Da = 0.038786490796;
w = 0.476369171411;
zg = 0.013049882576;
rf = 0.016044507489;
va = 2.562749963499;
yag = 0.013049882576;
iag = 0.013049882576;
sag = 0.013049882576;
la = -1.098612288668;
a = 0.000000000000;
rd = 0.01604450748878757200;
premd = 0.00000000000000000000;
DY4 = 0.01172998071942311600;
ika = -3.40715296389445130000;
n = 1.28343305998441350000;
markup = 0.29284996366943100000;
PS = 0.03612508854924336600;
ne = -2.60838723812621300000;
ka = 1.98898891470445220000;
markup_n = 0.24751235210564693000;
rf1 = 0.06417802995515058100;
l_1 = -2.698331029029;
x_1 = -1.790050282936;
D_1 = 0.028775151052;
ia_1 = -1.325053472199;
sa_1 = -2.889993688481;
Da_1 = 0.048100993955;
lambdak_1 = 0.000000000000;
lambdaz_1 = 0.000000000000;
k_1 = 0.389270174344;
phik_1 = -3.407152963894;
phiz_1 = -2.983104265472;
phiprik_1 = 0.000000000000;
phipriz_1 = 0.000000000000;
FE_1 = 1.226118924081;
n_1 = 1.692829317352;
ne_1 = -2.198990980759;
V_1 = 1.254894075133;
va_1 = 2.777980794111;
rd_1 = 0.016044507489;
z_1 = -1.599718740361;
ka_1 = 2.082099491695;
za_1 = 0.093110576991;
premd_1 = 0.000000000000;
rk_1 = -3.319417089886;
rz_1 = -2.924828210251;
markup_1 = 0.223143551314;
la_1 = -1.005501711677;
pa_1 = -0.156027764237;
p_1 = 0.191709543230;
l_2 = -1.779689803509;
x_2 = -0.809860095307;
D_2 = 0.028775151052;
ia_2 = -1.520842715328;
sa_2 = -3.085782931610;
Da_2 = 0.029471987636;
lambdak_2 = 0.000000000000;
lambdaz_2 = 0.000000000000;
k_2 = 1.307911399864;
phik_2 = -3.407152963894;
phiz_2 = -2.983104265472;
phiprik_2 = 0.000000000000;
phipriz_2 = 0.000000000000;
FE_2 = 1.226118924081;
n_2 = 0.578398848703;
ne_2 = -3.313421449408;
V_2 = 1.254894075133;
va_2 = 2.288118193431;
rd_2 = 0.016044507489;
z_2 = -0.681077514841;
ka_2 = 1.886310248567;
za_2 = -0.102678666138;
premd_2 = 0.000000000000;
rk_2 = -3.319417089886;
rz_2 = -2.924828210251;
markup_2 = 0.371563556432;
la_2 = -1.201290954806;
pa_2 = 0.159767155831;
p_2 = 0.278580586239;
end;
resid(0); 
check; 
steady; 
shocks;
var eps; stderr 1;
var eist_i; stderr 1;
var eist_s; stderr 1;
end;

steady(solve_algo = 1); 
check(qz_zero_threshold=1e-25); 
stoch_simul(periods=50000, irf=0, drop=0, replic=0, nograph, ar=0, nocorr, nofunctions, order=3 , pruning, k_order_solver);
